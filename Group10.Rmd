---
title: "Project - Group 10"
author: "Anthony Desdha, Santiago Fonnegra, Tim Haynes, Hayden Post, Vyvy Tran, Valeria Valle, Katie Yang"
date: "SDS 322E"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r message=FALSE}

library(tidyverse)

# select data Water_Quality <- read.csv("Water_Quality.csv")

Water_Quality <- read.csv("~/Water_Quality.csv", header=FALSE)

# Change the names of the variables to their retrospective column names 
col_names <- Water_Quality[1, ]
colnames(Water_Quality) <- col_names

# Remove the first row
Water_Quality_new <- Water_Quality[-1, ]

# Separate the month, day, year, time and meridium
Water_Quality_new <- Water_Quality_new %>% separate(SAMPLE_DATE, into = c("Date", "Time", "Meridium"), sep = " ")
Water_Quality_new <- Water_Quality_new %>% separate(Date, into = c("Month", "Day", "Year"), sep = "/") 

# Change the NA and long column names into specific column names 
colnames(Water_Quality_new)[colnames(Water_Quality_new) == "NA"] <- "ID"
colnames(Water_Quality_new)[colnames(Water_Quality_new) == "LAT_DD_WGS84"] <- "Latitude"
colnames(Water_Quality_new)[colnames(Water_Quality_new) == "LON_DD_WGS84"] <- "Longitude"

```

## Description

**Analyzing the relationship between pathogenic bacteria and organic nutrients present in freshwater samples taken in Austin.**

## Goals

**Our goals for this project is to observe how different organic nutrients and different locations can affect E.coli presence. Additionally, we also want to be able to analyze a data set and create/conclude data visualizations and answer our hypothesis.**

## Link to Data

**https://drive.google.com/file/d/13872S6iGB2MThwLKrlwKPZ2B5RK_kt5j/view?usp=sharing**

## Information on the Data

**This is a subset of the larger dataset of Water Quality in different waters in Austin and the different nutrients found in them.**

## Data Visualizations

```{r}
library(ggplot2)

# Visualization 1 Bar graph displaying Ecoli Presence by type of Watershed 

Water_Quality_new %>% group_by(PARAMETER)%>% filter(PARAMETER == "E COLI BACTERIA") %>% ggplot(aes(x=WATERSHED)) + geom_bar(alpha=1, size=2)+ theme(axis.text.x = element_text(angle = 45, vjust = 0.7)) + labs(x = 'Watershed', y = 'E. Coli Presence')

#Visualization 2 Bar graph displaying Ecoli Presence by type of Site type 
Water_Quality_new %>% group_by(PARAMETER)%>% filter(PARAMETER == "E COLI BACTERIA") %>% ggplot(aes(x=SITE_TYPE)) + geom_bar(alpha=1, size=2)+ theme(axis.text.x = element_text(angle = 45, vjust = 0.7)) + labs(x = 'Site Type', y = 'E. Coli Presence')
```

```{r}
# Visualization 3 Geomap of Ecoli presence using Colonies 
# Call the ggmap package

library(ggmap)
library(dplyr)

# Apply a google key 
register_google(key = "AIzaSyDr6jqdF-_3E85ni2nNRcZJ46ieUYokTpk")

# Filter for only the rows containing Ecoli concentrations based on colonies/100ml
Water_Quality_ecoli <- Water_Quality_new %>%
  filter(PARAMETER == "E COLI BACTERIA", UNIT == "Colonies/100mL")

# Find out how much missingness in the longitude and latitude columns for the filtered data
Water_Quality_ecoli %>% summarize_all (function(x)mean (!is.na(x)))

# Remove NA's in columns for latitude, longitude and concentration
Water_Quality_ecoli <- na.omit(Water_Quality_ecoli[, c("Longitude", "Latitude", "RESULT")])

# Make variables numeric
Water_Quality_ecoli$Longitude <- as.numeric(Water_Quality_ecoli$Longitude)
Water_Quality_ecoli$Latitude <- as.numeric(Water_Quality_ecoli$Latitude)
Water_Quality_ecoli$RESULT <- as.numeric(Water_Quality_ecoli$RESULT) 

# Label the parameters of the map 
map_data <- Water_Quality_ecoli %>%
  summarise(lat_min = min(Latitude),
            lat_max = max(Latitude),
            lon_min = min(Longitude),
            lon_max = max(Longitude))

# Use the parameters to obtain a map using get_googlemap
map <- get_googlemap(center = c(lon = mean(c(map_data$lon_min, map_data$lon_max)), lat = mean(c(map_data$lat_min, map_data$lat_max))), zoom = 10)

# Using ggmap create a map based on Ecoli concentration using color gradient 
ggmap(map) +
  geom_point(data = Water_Quality_ecoli, aes(x = Longitude, y = Latitude, color = RESULT), size = 1) +
  scale_color_gradient(name = "Ecoli Concentration using Colonies/100mL", low = "green", high = "red") +
  labs(title = "Ecoli Concentration Map Colonies/100ml",
       x = "Longitude",  # Replace with your actual x variable label
       y = "Latitude") +
  theme_minimal()

```

```{r}
# Visualization 4 Geomap of Ecoli presence using MPN/100ML 

# Call the ggmap package
library(ggmap)
library(dplyr)

# Apply a google key 
register_google(key = "AIzaSyDr6jqdF-_3E85ni2nNRcZJ46ieUYokTpk")

# Filter for only the rows containing Ecoli concentrations based on MPN/100ML
Water_Quality_ecoli_mpn <- Water_Quality_new %>%
  filter(PARAMETER == "E COLI BACTERIA", UNIT == "MPN/100ML")

# Find out how much missingness in the longitude and latitude columns for the filtered data
Water_Quality_ecoli_mpn %>% summarize_all (function(x)mean (!is.na(x)))

# Remove NA's in columns for latitude, longitude and concentration
Water_Quality_ecoli_mpn <- na.omit(Water_Quality_ecoli_mpn[, c("Longitude", "Latitude", "RESULT")])

# Make variables numeric
Water_Quality_ecoli_mpn$Longitude <- as.numeric(Water_Quality_ecoli_mpn$Longitude)
Water_Quality_ecoli_mpn$Latitude <- as.numeric(Water_Quality_ecoli_mpn$Latitude)
Water_Quality_ecoli_mpn$RESULT <- as.numeric(Water_Quality_ecoli_mpn$RESULT) 

# Label the parameters of the map 
map_data <- Water_Quality_ecoli_mpn %>%
  summarise(lat_min = min(Latitude),
            lat_max = max(Latitude),
            lon_min = min(Longitude),
            lon_max = max(Longitude))

# Use the parameters to obtain a map using get_googlemap
map <- get_googlemap(center = c(lon = mean(c(map_data$lon_min, map_data$lon_max)), lat = mean(c(map_data$lat_min, map_data$lat_max))), zoom = 10)

# Using ggmap create a map based on Ecoli concentration using color gradient 
ggmap(map) +
  geom_point(data = Water_Quality_ecoli_mpn, aes(x = Longitude, y = Latitude, color = RESULT), size = 1) +
  scale_color_gradient(name = "Ecoli Concentration using MPN/100ML", low = "green", high = "red") +
  labs(title = "Ecoli Concentration Map MPN/100ML",
  x = "Longitude", 
  y = "Latitude") +
  theme_minimal()
```

## Hypothesis

**1: Increasing human presence in public bodies of water will increase E. coli presence in popular attraction sites.  **

**2: If there is more running water in a particular body of water, then the presence of E. coli will increase.**

## References

**This data originally came from a larger data set describing the same variables. This originally data set is called "Water Quality Sampling Data" located on the data.austintexas.gov website.**
